<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8">
  <title>Convertor Date</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
      background-color: #f0f0f0;
    }
    input, select, button {
      padding: 6px;
      font-size: 16px;
      margin: 5px 0;
    }
    .section {
      background: white;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>

<h2>Convertor Date Calendaristice</h2>

<div class="section">
  <h3>DDMMYYYY → DWWY / DDDY</h3>
  <label>Dată (DDMMYYYY): <input id="inputDate" placeholder="ex: 05072025"></label><br>
  <button onclick="convertFromDate()">Convertește</button>
  <p><strong>DWWY:</strong> <span id="dwwyResult"></span></p>
  <p><strong>DDDY:</strong> <span id="dddyResult"></span></p>
</div>

<div class="section">
  <h3>DWWY → DDMMYYYY</h3>
  <label>DWWY (Ziua-săptămânii + Nr. săptămână + An): <input id="dwwyInput" placeholder="ex:2052025"></label><br>
  <button onclick="convertFromDWWY()">Convertește</button>
  <p><strong>DDMMYYYY:</strong> <span id="dwwyToDateResult"></span></p>
</div>

<div class="section">
  <h3>DDDY → DDMMYYYY</h3>
  <label>DDDY (Ziua-anului + An): <input id="dddyInput" placeholder="ex:1872025"></label><br>
  <button onclick="convertFromDDDY()">Convertește</button>
  <p><strong>DDMMYYYY:</strong> <span id="dddyToDateResult"></span></p>
</div>

<script>
function convertFromDate() {
  const dateStr = document.getElementById("inputDate").value.trim();
  const day = parseInt(dateStr.slice(0,2), 10);
  const month = parseInt(dateStr.slice(2,4), 10) - 1;
  const year = parseInt(dateStr.slice(4,8), 10);

  const date = new Date(year, month, day);
  if (isNaN(date)) return alert("Dată invalidă.");

  // DWWY
  const weekday = date.getDay(); // 0 (Duminică) -> 6 (Sâmbătă)
  const oneJan = new Date(date.getFullYear(), 0, 1);
  const daysSinceJan1 = Math.floor((date - oneJan) / 86400000);
  const weekNum = Math.ceil((daysSinceJan1 + oneJan.getDay() + 1) / 7);

  const dwwy = `${weekday}${weekNum.toString().padStart(2, '0')}${year}`;

  // DDDY
  const dayOfYear = Math.floor((date - new Date(date.getFullYear(), 0, 0)) / 86400000);
  const dddy = `${dayOfYear.toString().padStart(3, '0')}${year}`;

  document.getElementById("dwwyResult").textContent = dwwy;
  document.getElementById("dddyResult").textContent = dddy;
}

function convertFromDWWY() {
  const input = document.getElementById("dwwyInput").value.trim();
  const weekday = parseInt(input.slice(0, 1), 10);
  const weekNum = parseInt(input.slice(1, 3), 10);
  const year = parseInt(input.slice(3), 10);

  // Găsim prima zi a anului
  const janFirst = new Date(year, 0, 1);
  const janFirstDay = janFirst.getDay();
  let daysToAdd = (weekNum - 1) * 7 + (weekday - janFirstDay);
  if (janFirstDay > weekday) daysToAdd += 7;

  const resultDate = new Date(year, 0, 1 + daysToAdd);
  const dd = resultDate.getDate().toString().padStart(2, '0');
  const mm = (resultDate.getMonth() + 1).toString().padStart(2, '0');
  const yyyy = resultDate.getFullYear();

  document.getElementById("dwwyToDateResult").textContent = `${dd}${mm}${yyyy}`;
}

function convertFromDDDY() {
  const input = document.getElementById("dddyInput").value.trim();
  const dayOfYear = parseInt(input.slice(0, 3), 10);
  const year = parseInt(input.slice(3), 10);

  const date = new Date(year, 0);
  date.setDate(dayOfYear);

  const dd = date.getDate().toString().padStart(2, '0');
  const mm = (date.getMonth() + 1).toString().padStart(2, '0');
  const yyyy = date.getFullYear();

  document.getElementById("dddyToDateResult").textContent = `${dd}${mm}${yyyy}`;
}
</script>

</body>
</html>
